<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>shopThat â€” Financials</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/dashboard.css">
  </head>
  <body class="app app--financials">
    <aside class="sidebar" aria-label="Primary">
      <div class="sidebar__brand">
        <span>shopThat</span>
      </div>
      <nav class="sidebar__nav">
        <a href="/dashboard.html">Dashboard</a>
        <a href="/keywords.html">Keywords</a>
        <a href="/internals.html">Internals</a>
        <a href="/publishers.html" aria-disabled="true">Publishers</a>
        <a href="/open-source.html" aria-disabled="true">Open source</a>
        <a href="/products.html">Products</a>
        <a class="is-active" href="/financials.html">Financials</a>
        <a href="/settings.html" aria-disabled="true">Settings</a>
        <a href="#" aria-disabled="true">Sign Out</a>
      </nav>
      <div class="sidebar__cta">
        <div class="cta">
          <div class="cta__title">shopThat</div>
          <div class="cta__desc">Get access to all features on shopThat</div>
          <button class="cta__btn" type="button">Upgrade</button>
        </div>
      </div>
    </aside>

    <header class="appbar" role="banner">
      <div class="appbar__inner">
        <h1 class="appbar__title">Financials</h1>
        <div class="appbar__search">
          <input type="search" placeholder="Search here..." aria-label="Search" />
        </div>
        <div class="appbar__account">
          <span class="locale">Eng (US)</span>
          <button class="icon-btn" aria-label="Notifications" title="Notifications">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M18 8a6 6 0 10-12 0c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 01-3.46 0"/>
            </svg>
          </button>
          <button class="icon-btn" id="darkModeToggle" aria-label="Toggle dark mode" title="Toggle dark mode">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <circle cx="12" cy="12" r="5"/>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
          </button>
          <div class="avatar" role="img" aria-label="Person, Admin"></div>
        </div>
      </div>
    </header>

    <main id="main" class="dashboard" role="main">
      <!-- Page Title with Campaign Switcher -->
      <div class="page-header">
        <div class="campaign-selector">
          <div class="campaign-dropdown-wrapper">
            <div class="campaign-arrow">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="6,9 12,15 18,9"></polyline>
              </svg>
            </div>
            <span class="campaign-text" id="campaignText">Kusama Campaign</span>
            <div class="campaign-dropdown" id="campaignDropdown">
              <div class="campaign-option" data-value="kusama">Kusama Campaign</div>
              <div class="campaign-option" data-value="murakami">Murakami Campaign</div>
              <div class="campaign-option" data-value="core-values">Core Values Campaign</div>
            </div>
          </div>
        </div>
      </div>

      <!-- First Row - Spend and Metrics -->
      <div class="grid kpis-investor-style">
        <!-- Monthly Spend Circle (no card wrapper) -->
        <div class="spend-circle-standalone">
          <div class="spend-circle">
            <div class="spend-amount">$20,000</div>
            <div class="spend-label">Spend this month</div>
            <div class="spend-progress">
              <div class="progress-indicator">
                <span class="progress-percentage">50%</span>
                <span class="progress-change">+20,000</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Combined Performance & Engagement Metrics -->
        <div class="rpv-section-combined">
          <div class="section-header">
            <h3>Performance & Engagement Metrics</h3>
          </div>
          <div class="combined-metrics">
            <div class="metric-item">
              <div class="metric-label">Publisher Led Conversions</div>
              <div class="metric-value rpv-green">1000</div>
            </div>
            <div class="metric-item">
              <div class="metric-label">Cost Per Conversion</div>
              <div class="metric-value">$1.25</div>
              <div class="metric-unit">1.5% improvement</div>
            </div>
            <div class="metric-item">
              <div class="metric-label">Keyword Click in Chatbot</div>
              <div class="metric-value">200,000</div>
            </div>
            <div class="metric-item">
              <div class="metric-label">Click Percentage</div>
              <div class="metric-value">20%</div>
            </div>
            <div class="metric-item">
              <div class="metric-label">Average Cost</div>
              <div class="metric-value">$0.02</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Second Row - Publishers Full Width -->
      <div class="grid publishers-top">
        <div class="card publishers-card-top">
          <div class="card__header">
            <h2>Publishers Metrics</h2>
          </div>
          <div class="publishers-content-top">
            <div class="publishers-section highlighted">
              <div class="section-title">Top Articles</div>
              <div class="section-content">Vogue, WWD, InStyle</div>
            </div>
            <div class="publishers-section">
              <div class="section-title">Highest Cost Articles</div>
              <div class="section-content numeric">$ 2</div>
            </div>
            <div class="publishers-section">
              <div class="section-title">Highest Cost Keyword</div>
              <div class="section-content numeric">$ 0.50</div>
            </div>
            <div class="publishers-section">
              <div class="section-title">Conversion For Internal Data</div>
              <div class="section-content numeric">2%</div>
            </div>
            <div class="publishers-section">
              <div class="section-title">Conversion for External Data</div>
              <div class="section-content numeric">3%</div>
            </div>
            <div class="publishers-section highlighted">
              <div class="section-title">Top Publisher Led Conversions</div>
              <div class="section-content">Vogue, WWD, InStyle</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts Row (full width) -->
      <div class="grid charts-fullwidth">
        <!-- Kusama Top Keywords Chart -->
        <div class="card chart-card">
          <div class="card__header">
            <h2>Kusama Top Keywords (Performance)</h2>
          </div>
          <div class="chart-container">
            <canvas id="keywordsChart" aria-label="Kusama keywords performance over time"></canvas>
          </div>
          <div class="chart-legend-bottom">
            <div class="legend-item">
              <div class="legend-color" style="background-color: #ef4444;"></div>
              <span>Art</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #3b82f6;"></div>
              <span>Museum</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #10b981;"></div>
              <span>Polka Dots</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #8b5cf6;"></div>
              <span>Infinity Mirror</span>
            </div>
          </div>
        </div>

        <!-- Conversion Graph -->
        <div class="card chart-card">
          <div class="card__header">
            <h2>Conversion Graph (Revenue to Keyword Spend)</h2>
          </div>
          <div class="chart-container">
            <canvas id="conversionChart" aria-label="Revenue to keyword spend conversion"></canvas>
          </div>
        </div>
      </div>

    </main>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      // Campaign data
      const campaignData = {
        kusama: {
          spend: '$20,000',
          conversions: '1000',
          costPerConversion: '$1.25',
          improvement: '1.5%',
          chatbotClicks: '200,000',
          clickPercentage: '20%',
          avgCost: '$0.02',
          publishers: {
            topArticles: 'Vogue, WWD, InStyle',
            highestCost: '$ 2',
            highestKeyword: '$ 0.50',
            internalConversion: '2%',
            externalConversion: '3%',
            topConversions: 'Vogue, WWD, InStyle'
          }
        },
        murakami: {
          spend: '$15,000',
          conversions: '850',
          costPerConversion: '$1.76',
          improvement: '2.1%',
          chatbotClicks: '175,000',
          clickPercentage: '18%',
          avgCost: '$0.03',
          publishers: {
            topArticles: 'Elle, Harper\'s Bazaar, Vogue',
            highestCost: '$ 1.8',
            highestKeyword: '$ 0.45',
            internalConversion: '1.8%',
            externalConversion: '2.7%',
            topConversions: 'Elle, Harper\'s Bazaar'
          }
        },
        'core-values': {
          spend: '$12,500',
          conversions: '720',
          costPerConversion: '$1.74',
          improvement: '1.8%',
          chatbotClicks: '150,000',
          clickPercentage: '15%',
          avgCost: '$0.025',
          publishers: {
            topArticles: 'Forbes, Business Week, WSJ',
            highestCost: '$ 1.5',
            highestKeyword: '$ 0.40',
            internalConversion: '1.5%',
            externalConversion: '2.2%',
            topConversions: 'Forbes, Business Week'
          }
        }
      };

      // Campaign switching functionality
      function initCampaignSwitcher() {
        const dropdownWrapper = document.querySelector('.campaign-dropdown-wrapper');
        const dropdown = document.getElementById('campaignDropdown');
        const campaignText = document.getElementById('campaignText');
        const campaignOptions = document.querySelectorAll('.campaign-option');
        
        let isOpen = false;
        let selectedCampaign = 'kusama';
        
        // Update selected option styling
        function updateSelectedOption() {
          campaignOptions.forEach(option => {
            option.classList.remove('selected');
            if (option.dataset.value === selectedCampaign) {
              option.classList.add('selected');
            }
          });
        }
        
        // Toggle dropdown
        function toggleDropdown() {
          isOpen = !isOpen;
          dropdownWrapper.classList.toggle('open', isOpen);
          dropdown.classList.toggle('open', isOpen);
        }
        
        // Close dropdown
        function closeDropdown() {
          if (isOpen) {
            isOpen = false;
            dropdownWrapper.classList.remove('open');
            dropdown.classList.remove('open');
          }
        }
        
        // Handle campaign selection
        function selectCampaign(value, text) {
          selectedCampaign = value;
          campaignText.textContent = text;
          updateSelectedOption();
          updateDashboardData(value);
          closeDropdown();
        }
        
        // Event listeners
        if (dropdownWrapper) {
          dropdownWrapper.addEventListener('click', (e) => {
            e.stopPropagation();
            toggleDropdown();
          });
        }
        
        campaignOptions.forEach(option => {
          option.addEventListener('click', (e) => {
            e.stopPropagation();
            selectCampaign(option.dataset.value, option.textContent);
          });
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
          closeDropdown();
        });
        
        // Initialize
        updateSelectedOption();
      }

      function updateDashboardData(campaign) {
        const data = campaignData[campaign];
        if (!data) return;

        // Update spend circle
        const spendAmount = document.querySelector('.spend-amount');
        if (spendAmount) spendAmount.textContent = data.spend;

        // Update combined performance & engagement metrics
        const combinedMetrics = document.querySelectorAll('.combined-metrics .metric-item');
        if (combinedMetrics.length >= 5) {
          // Publisher Led Conversions
          combinedMetrics[0].querySelector('.metric-value').textContent = data.conversions;
          
          // Cost Per Conversion
          combinedMetrics[1].querySelector('.metric-value').textContent = data.costPerConversion;
          combinedMetrics[1].querySelector('.metric-unit').textContent = data.improvement + ' improvement';
          
          // Keyword Click in Chatbot
          combinedMetrics[2].querySelector('.metric-value').textContent = data.chatbotClicks;
          
          // Click Percentage
          combinedMetrics[3].querySelector('.metric-value').textContent = data.clickPercentage;
          
          // Average Cost
          combinedMetrics[4].querySelector('.metric-value').textContent = data.avgCost;
        }

        // Update publishers data
        const publisherSections = document.querySelectorAll('.publishers-section');
        if (publisherSections.length >= 6) {
          // Top Articles (text only - no numeric class)
          publisherSections[0].querySelector('.section-content').textContent = data.publishers.topArticles;
          
          // Highest Cost Articles (numeric)
          const highestCostEl = publisherSections[1].querySelector('.section-content');
          highestCostEl.textContent = data.publishers.highestCost;
          highestCostEl.classList.add('numeric');
          
          // Highest Cost Keyword (numeric)
          const highestKeywordEl = publisherSections[2].querySelector('.section-content');
          highestKeywordEl.textContent = data.publishers.highestKeyword;
          highestKeywordEl.classList.add('numeric');
          
          // Internal Conversion (numeric)
          const internalEl = publisherSections[3].querySelector('.section-content');
          internalEl.textContent = data.publishers.internalConversion;
          internalEl.classList.add('numeric');
          
          // External Conversion (numeric)
          const externalEl = publisherSections[4].querySelector('.section-content');
          externalEl.textContent = data.publishers.externalConversion;
          externalEl.classList.add('numeric');
          
          // Top Conversions (text only - no numeric class)
          publisherSections[5].querySelector('.section-content').textContent = data.publishers.topConversions;
        }

        // Update charts if needed (placeholder for future enhancement)
        updateCharts(campaign);
      }

      function updateCharts(campaign) {
        // Placeholder for updating chart data based on selected campaign
        // This could be enhanced to show different data sets for each campaign
        console.log('Updating charts for campaign:', campaign);
      }

      // Dark mode functionality
      function initDarkMode() {
        const darkModeToggle = document.getElementById('darkModeToggle');
        const body = document.body;
        
        // Check for saved dark mode preference
        const isDarkMode = localStorage.getItem('darkMode') === 'true';
        if (isDarkMode) {
          body.classList.add('dark-mode');
        }
        
        // Toggle dark mode
        if (darkModeToggle) {
          darkModeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            const isNowDark = body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isNowDark);
          });
        }
      }

      // Initialize charts
      function initCharts() {
        // Keywords Performance Chart
        const keywordsCtx = document.getElementById('keywordsChart');
        if (keywordsCtx) {
          new Chart(keywordsCtx, {
            type: 'line',
            data: {
              labels: ['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN'],
              datasets: [
                {
                  label: 'Art',
                  data: [20, 35, 45, 55, 40, 50, 35],
                  borderColor: '#ef4444',
                  backgroundColor: 'rgba(239, 68, 68, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'Museum',
                  data: [30, 25, 35, 30, 45, 35, 40],
                  borderColor: '#3b82f6',
                  backgroundColor: 'rgba(59, 130, 246, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'Polka Dots',
                  data: [15, 30, 25, 40, 20, 45, 50],
                  borderColor: '#10b981',
                  backgroundColor: 'rgba(16, 185, 129, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'Infinity Mirror',
                  data: [25, 20, 30, 35, 25, 30, 25],
                  borderColor: '#8b5cf6',
                  backgroundColor: 'rgba(139, 92, 246, 0.1)',
                  tension: 0.4
                }
              ]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: false
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  grid: {
                    color: '#f3f4f6'
                  }
                },
                x: {
                  grid: {
                    color: '#f3f4f6'
                  }
                }
              }
            }
          });
        }

        // Conversion Chart
        const conversionCtx = document.getElementById('conversionChart');
        if (conversionCtx) {
          new Chart(conversionCtx, {
            type: 'line',
            data: {
              labels: ['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT', 'SUN'],
              datasets: [
                {
                  label: 'Revenue',
                  data: [20, 40, 60, 80, 55, 70, 65],
                  borderColor: '#06b6d4',
                  backgroundColor: 'rgba(6, 182, 212, 0.1)',
                  tension: 0.4
                },
                {
                  label: 'Keyword Spend',
                  data: [30, 35, 25, 45, 20, 60, 70],
                  borderColor: '#8b5cf6',
                  backgroundColor: 'rgba(139, 92, 246, 0.1)',
                  tension: 0.4
                }
              ]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: false
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  grid: {
                    color: '#f3f4f6'
                  }
                },
                x: {
                  grid: {
                    color: '#f3f4f6'
                  }
                }
              }
            }
          });
        }
      }
      
      // Initialize when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          initDarkMode();
          initCampaignSwitcher();
          initCharts();
        });
      } else {
        initDarkMode();
        initCampaignSwitcher();
        initCharts();
      }
    </script>
  </body>
</html>
